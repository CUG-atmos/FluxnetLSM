<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FLUXNET2015 processing • FluxnetLSM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="FLUXNET2015 processing">
<meta property="og:description" content="FluxnetLSM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FluxnetLSM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/FLUXNET2015_processing.html">FLUXNET2015 processing</a>
    </li>
    <li>
      <a href="../articles/lathuile_processing.html">LaThuile processing</a>
    </li>
    <li>
      <a href="../articles/meta_data.html">Meta-data description</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/aukkola/FluxnetLSM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>FLUXNET2015 processing</h1>
                        <h4 data-toc-skip class="author">Koen
Hufkens</h4>
            
            <h4 data-toc-skip class="date">2022-05-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/aukkola/FluxnetLSM/blob/HEAD/vignettes/FLUXNET2015_processing.Rmd" class="external-link"><code>vignettes/FLUXNET2015_processing.Rmd</code></a></small>
      <div class="hidden name"><code>FLUXNET2015_processing.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="single-site">Single site<a class="anchor" aria-label="anchor" href="#single-site"></a>
</h2>
<p>Example data conversion for the Howard Springs site using
FLUXNET2015.</p>
<p>See LaThuile/example_conversion_single_site.R for the corresponding
La Thuile example.</p>
<p>Converts useful variables from a FLUXNET2015 “FULLSET” spreatsheet
format into two netcdf files, one for fluxes, and one for met forcings.
For “SUBSET” data, set flx2015_version=“SUBSET” in the main
function.</p>
<p>The user must provide the input directory path, output directory path
and site code. All other settings are optional. This example uses
ERAinterim gapfilling for meteorological variables, all other options
are set to their default values.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/aukkola/FluxnetLSM" class="external-link">FluxnetLSM</a></span><span class="op">)</span> 


<span class="co">#############################</span>
<span class="co">###--- Required inputs ---###</span>
<span class="co">#############################</span>

<span class="co">#--- User must define these ---#</span>

<span class="co">#Fluxnet site ID (see http://fluxnet.fluxdata.org/sites/site-list-and-pages/)</span>
<span class="va">site_code</span> <span class="op">&lt;-</span> <span class="st">"AU-How"</span>

<span class="co"># This directory should contain appropriate data from </span>
<span class="co"># http://fluxnet.fluxdata.org/data/fluxnet2015-dataset/</span>
<span class="va">in_path</span> <span class="op">&lt;-</span> <span class="st">"./Inputs"</span>
<span class="va">ERA_path</span> <span class="op">&lt;-</span> <span class="st">"./ERA_inputs"</span>

<span class="co">#Outputs will be saved to this directory</span>
<span class="va">out_path</span> <span class="op">&lt;-</span> <span class="st">"./Outputs"</span>


<span class="co">#--- Automatically retrieve all Fluxnet files in input directory ---#</span>

<span class="co"># Input Fluxnet data file (using FULLSET in this example, see R/Helpers.R for details)</span>
<span class="va">infile</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fluxnet_files.html">get_fluxnet_files</a></span><span class="op">(</span><span class="va">in_path</span>, <span class="va">site_code</span><span class="op">)</span>

<span class="co">#Retrieve dataset version</span>
<span class="va">datasetversion</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fluxnet_version_no.html">get_fluxnet_version_no</a></span><span class="op">(</span><span class="va">infile</span><span class="op">)</span>
  
<span class="co">#Retrieve ERAinterim file</span>
<span class="va">era_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fluxnet_erai_files.html">get_fluxnet_erai_files</a></span><span class="op">(</span><span class="va">ERA_path</span>, <span class="va">site_code</span><span class="op">)</span>


<span class="co">###############################</span>
<span class="co">###--- Optional settings ---###</span>
<span class="co">###############################</span>

<span class="co">#Retrieve default processing options</span>
<span class="va">conv_opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_default_conversion_options.html">get_default_conversion_options</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Set gapfilling options to ERAinterim</span>
<span class="va">conv_opts</span><span class="op">$</span><span class="va">met_gapfill</span>  <span class="op">&lt;-</span> <span class="st">"ERAinterim"</span>


<span class="co">##########################</span>
<span class="co">###--- Run analysis ---###</span>
<span class="co">##########################</span>

<span class="fu"><a href="../reference/convert_fluxnet_to_netcdf.html">convert_fluxnet_to_netcdf</a></span><span class="op">(</span>site_code <span class="op">=</span> <span class="va">site_code</span>, infile <span class="op">=</span> <span class="va">infile</span>,
                          era_file<span class="op">=</span><span class="va">era_file</span>, out_path <span class="op">=</span> <span class="va">out_path</span>,
                          conv_opts <span class="op">=</span> <span class="va">conv_opts</span><span class="op">)</span>

<span class="co">#Alternatively you can pass the gapfilling option directly to the main function:</span>
<span class="co"># convert_fluxnet_to_netcdf(site_code = site_code, infile = infile, </span>
<span class="co">#                           era_file = era_file, out_path = out_path,</span>
<span class="co">#                           met_gapfill="ERAinterim")</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="multiple-sites">Multiple sites<a class="anchor" aria-label="anchor" href="#multiple-sites"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- Automatically retrieve all Fluxnet files in input directory ---#</span>

<span class="co"># Input Fluxnet data files (using FULLSET in this example, se R/Helpers.R for details)</span>
<span class="va">infiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fluxnet_files.html">get_fluxnet_files</a></span><span class="op">(</span><span class="va">in_path</span><span class="op">)</span>

<span class="co">#Retrieve dataset versions</span>
<span class="va">datasetversions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">infiles</span>, <span class="va">get_fluxnet_version_no</span><span class="op">)</span>

<span class="co">#Retrieve site codes</span>
<span class="va">site_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">infiles</span>, <span class="va">get_path_site_code</span><span class="op">)</span>


<span class="co">###############################</span>
<span class="co">###--- Optional settings ---###</span>
<span class="co">###############################</span>

<span class="va">conv_opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_default_conversion_options.html">get_default_conversion_options</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># ERAinterim meteo file for gap-filling met data (set to NA if not desired)</span>
<span class="co"># Find ERA-files corresponding to site codes</span>
<span class="va">conv_opts</span><span class="op">$</span><span class="va">met_gapfill</span>  <span class="op">&lt;-</span> <span class="st">"ERAinterim"</span>
<span class="va">ERA_files</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">site_codes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/get_fluxnet_erai_files.html">get_fluxnet_erai_files</a></span><span class="op">(</span><span class="va">ERA_path</span>, site_code<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>

<span class="co">#Stop if didn't find ERA files</span>
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ERA_files</span>, <span class="va">length</span><span class="op">)</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">conv_opts</span><span class="op">$</span><span class="va">met_gapfill</span><span class="op">==</span><span class="st">"ERAinterim"</span><span class="op">)</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"No ERA files found, amend input path"</span><span class="op">)</span>
<span class="op">}</span>


<span class="co">##########################</span>
<span class="co">###--- Run analysis ---###</span>
<span class="co">##########################</span>

<span class="co">#Loops through sites</span>
<span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">site_code</span>, <span class="va">infile</span>, <span class="va">ERA_file</span>, <span class="va">datasetversion</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span>
            <span class="fu"><a href="../reference/convert_fluxnet_to_netcdf.html">convert_fluxnet_to_netcdf</a></span><span class="op">(</span>site_code <span class="op">=</span> <span class="va">site_code</span>,
                                      infile <span class="op">=</span> <span class="va">infile</span>,
                                      out_path <span class="op">=</span> <span class="va">out_path</span>,
                                      era_file <span class="op">=</span> <span class="va">ERA_file</span>,
                                      conv_opts <span class="op">=</span> <span class="va">conv_opts</span>,
                                      datasetversion <span class="op">=</span> <span class="va">datasetversion</span>
                                      <span class="op">)</span>
        <span class="op">)</span><span class="op">}</span>,
    site_code <span class="op">=</span> <span class="va">site_codes</span>,
    infile <span class="op">=</span> <span class="va">infiles</span>,
    ERA_file <span class="op">=</span> <span class="va">ERA_files</span>,
    datasetversion <span class="op">=</span> <span class="va">datasetversions</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="multiple-sites-parallel">Multiple sites (parallel)<a class="anchor" aria-label="anchor" href="#multiple-sites-parallel"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Get default conversion options. See help(get_default_conversion_options)</span>
<span class="va">conv_opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_default_conversion_options.html">get_default_conversion_options</a></span><span class="op">(</span><span class="op">)</span>


<span class="co">#--- Automatically retrieve all Fluxnet files in input directory ---#</span>

<span class="co"># Input Fluxnet data files (using FULLSET in this example, se R/Helpers.R for details)</span>
<span class="va">infiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fluxnet_files.html">get_fluxnet_files</a></span><span class="op">(</span><span class="va">in_path</span>,
                             datasetname <span class="op">=</span> <span class="va">conv_opts</span><span class="op">$</span><span class="va">datasetname</span>,
                             subset <span class="op">=</span> <span class="va">conv_opts</span><span class="op">$</span><span class="va">flx2015_version</span><span class="op">)</span>

<span class="co">#Retrieve dataset versions</span>
<span class="va">datasetversions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">infiles</span>, <span class="va">get_fluxnet_version_no</span><span class="op">)</span>

<span class="co">#Retrieve site codes</span>
<span class="va">site_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">infiles</span>, <span class="va">get_path_site_code</span><span class="op">)</span>


<span class="co">###############################</span>
<span class="co">###--- Optional settings ---###</span>
<span class="co">###############################</span>

<span class="co"># ERAinterim meteo file for gap-filling met data (set to FALSE if not desired)</span>
<span class="co"># Find ERA-files corresponding to site codes</span>
<span class="va">ERA_gapfill</span>  <span class="op">&lt;-</span> <span class="cn">TRUE</span>
<span class="va">ERA_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">site_codes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
                    <span class="fu"><a href="../reference/get_fluxnet_erai_files.html">get_fluxnet_erai_files</a></span><span class="op">(</span><span class="va">ERA_path</span>, site_code <span class="op">=</span> <span class="va">x</span>,
                                           datasetname <span class="op">=</span> <span class="va">conv_opts</span><span class="op">$</span><span class="va">datasetname</span><span class="op">)</span>
                    <span class="op">}</span><span class="op">)</span>

<span class="co">#Stop if didn't find ERA files</span>
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ERA_files</span>, <span class="va">length</span><span class="op">)</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">ERA_gapfill</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"No ERA files found, amend input path"</span><span class="op">)</span>
<span class="op">}</span>


<span class="co">#Thresholds for missing and gap-filled time steps</span>
<span class="co">#Note: Always checks for missing values. If no gapfilling </span>
<span class="co">#thresholds set, will not check for gap-filling.</span>
<span class="va">conv_opts</span><span class="op">$</span><span class="va">missing</span>      <span class="op">&lt;-</span> <span class="fl">15</span> <span class="co">#max. percent missing (must be set)</span>
<span class="va">conv_opts</span><span class="op">$</span><span class="va">gapfill_all</span>  <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co">#max. percent gapfilled (optional)</span>
<span class="va">conv_opts</span><span class="op">$</span><span class="va">gapfill_good</span> <span class="op">&lt;-</span> <span class="cn">NA</span> <span class="co">#max. percent good-quality gapfilled (optional, ignored if gapfill_all set)</span>
<span class="va">conv_opts</span><span class="op">$</span><span class="va">gapfill_med</span>  <span class="op">&lt;-</span> <span class="cn">NA</span> <span class="co">#max. percent medium-quality gapfilled (optional, ignored if gapfill_all set)</span>
<span class="va">conv_opts</span><span class="op">$</span><span class="va">gapfill_poor</span> <span class="op">&lt;-</span> <span class="cn">NA</span> <span class="co">#max. percent poor-quality gapfilled (optional, ignored if gapfill_all set)</span>
<span class="va">conv_opts</span><span class="op">$</span><span class="va">min_yrs</span>      <span class="op">&lt;-</span> <span class="fl">2</span>  <span class="co">#min. number of consecutive years</span>
<span class="va">conv_opts</span><span class="op">$</span><span class="va">met_gapfill</span>  <span class="op">&lt;-</span> <span class="st">"ERAinterim"</span>  <span class="co">#min. number of consecutive years</span>

<span class="co">#Should code produce plots to visualise outputs? Set to NA if not desired.</span>
<span class="co">#(annual: average monthly cycle; diurnal: average diurnal cycle by season;</span>
<span class="co">#timeseries: 14-day running mean time series)</span>
<span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"annual"</span>, <span class="st">"diurnal"</span>,<span class="st">"timeseries"</span><span class="op">)</span>

<span class="co">#Should all evaluation variables be included regardless of data gaps?</span>
<span class="co">#If FALSE, removes evaluation variables with gaps in excess of thresholds</span>
<span class="va">conv_opts</span><span class="op">$</span><span class="va">include_all_eval</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>


<span class="co">##########################</span>
<span class="co">###--- Run analysis ---###</span>
<span class="co">##########################</span>

<span class="co">#Initialise clusters (using 2 cores here)</span>
<span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">makeCluster</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">'cl.cores'</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="co">#Import variables to cluster</span>
<span class="fu">clusterExport</span><span class="op">(</span><span class="va">cl</span>, <span class="st">"out_path"</span><span class="op">)</span>
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"conv_opts"</span><span class="op">)</span><span class="op">)</span>  <span class="op">{</span><span class="fu">clusterExport</span><span class="op">(</span><span class="va">cl</span>, <span class="st">"conv_opts"</span><span class="op">)</span><span class="op">}</span>
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"datasetversion"</span><span class="op">)</span><span class="op">)</span>   <span class="op">{</span><span class="fu">clusterExport</span><span class="op">(</span><span class="va">cl</span>, <span class="st">"datasetversion"</span><span class="op">)</span><span class="op">}</span>
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span><span class="op">)</span>             <span class="op">{</span><span class="fu">clusterExport</span><span class="op">(</span><span class="va">cl</span>, <span class="st">"plot"</span><span class="op">)</span><span class="op">}</span>


<span class="co">#Loops through sites</span>
<span class="fu">clusterMap</span><span class="op">(</span>cl <span class="op">=</span> <span class="va">cl</span>, <span class="kw">function</span><span class="op">(</span><span class="va">site_code</span>, <span class="va">infile</span>, <span class="va">ERA_file</span>, <span class="va">datasetversion</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/aukkola/FluxnetLSM" class="external-link">FluxnetLSM</a></span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span>
        <span class="fu"><a href="../reference/convert_fluxnet_to_netcdf.html">convert_fluxnet_to_netcdf</a></span><span class="op">(</span>
            site_code <span class="op">=</span> <span class="va">site_code</span>,
            infile <span class="op">=</span> <span class="va">infile</span>,
            era_file <span class="op">=</span> <span class="va">ERA_file</span>,
            out_path<span class="op">=</span><span class="va">out_path</span>,
            conv_opts <span class="op">=</span> <span class="va">conv_opts</span>,
            plot <span class="op">=</span> <span class="va">plot</span>,
            datasetversion <span class="op">=</span> <span class="va">datasetversion</span>  <span class="co"># overrides conv_opts</span>
            <span class="op">)</span>,
         error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NULL</span><span class="op">)</span>
    <span class="op">}</span>,
    site_code <span class="op">=</span> <span class="va">site_codes</span>,
    infile <span class="op">=</span> <span class="va">infiles</span>,
    datasetversion <span class="op">=</span> <span class="va">datasetversions</span>,
    ERA_file <span class="op">=</span> <span class="va">ERA_files</span><span class="op">)</span>

<span class="fu">stopCluster</span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ukkola Anna.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
